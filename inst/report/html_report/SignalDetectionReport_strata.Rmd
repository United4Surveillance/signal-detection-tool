{{pathogen}}-{{strat}} {.hidden}
===========================================================================

```{r}
strat_text <- dplyr::case_when(
  "{{strat}}" == "age_group" ~ "agegroup",
  TRUE ~ "{{strat}}"
)
```

```{r, results='asis'}
results_analysis <- signals_agg %>%
  dplyr::filter(any_alarms, category %in% "{{strat}}")
```

```{r}
df <- signals_padded %>%
  dplyr::filter(category %in% "{{strat}}") %>%
  SignalDetectionTool:::create_factor_with_unknown()

number_stratum <- dplyr::n_distinct(df$stratum)

if (number_stratum <= 10) {
  p_height <- ceiling(dplyr::n_distinct(df$stratum) / 2) * 2
} else {
  p_height <- 12
}

pages <- ceiling(number_stratum / 12)

txt <- NULL
```

Row {.tabset}
-------------------------------------------------------------------------------
```{r, results='asis'}
for(st in unique(df$stratum)){
  cat("### Signals Timeseries - ", st, "\n")
  
  plot_stratum <- plot_time_series(
    df %>% dplyr::filter(.data[["stratum"]] == st),
    number_of_weeks = 52,
    intervention_date = params$intervention_date,
    interactive = FALSE
  ) +
  ggplot2::scale_x_date(
    date_breaks = "2 months", date_labels = "%Y-%m-%d",
    expand = c(0, 0)
  )
  
  print(plot_stratum)
  
  cat("\n\n\n")
}
```

